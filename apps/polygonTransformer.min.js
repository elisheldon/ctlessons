var c=document.getElementById("coordinatePlane"),ctx=c.getContext("2d"),planeWidth=1200,planeHeight=500,gridSize=25,p0Canvas=[],p0Cart=[],p1Canvas=[],p1Cart=[],p2Canvas=[],p2Cart=[],p3Canvas=[],p3Cart=[],polygon=0,rowsArray=[],drawn=!1,p0Color="#FF0000",p1Color="#008000",p2Color="#0000FF",p3Color="#FF00FF",showValues=!1;function drawBackground(){for(ctx.beginPath(),i=1;i<planeWidth/gridSize;i++)ctx.moveTo(gridSize*i,0),ctx.lineTo(gridSize*i,planeHeight);for(i=1;i<planeHeight/gridSize;i++)ctx.moveTo(0,gridSize*i),ctx.lineTo(planeWidth,gridSize*i);ctx.lineWidth=.5,ctx.strokeStyle="#808080",ctx.stroke(),ctx.beginPath(),ctx.moveTo(planeWidth/2,0),ctx.lineTo(planeWidth/2,planeHeight),ctx.moveTo(0,planeHeight/2),ctx.lineTo(planeWidth,planeHeight/2),ctx.lineWidth=gridSize/5,ctx.strokeStyle="#000000",ctx.stroke()}function drawp0(){clear(),document.getElementById("clearButton").disabled=!1,document.getElementById("drawp0Button").disabled=!0,document.getElementById("showValuesButton").disabled=!1;var e=0;if(document.getElementById("pairsInput").value.match(/[a-zA-Z+!@#$%^&*;?\/=_~()|]|\.\./))e=1;else{for(rowsArray=document.getElementById("pairsInput").value.split("\n"),i=0;i<rowsArray.length;i++)""!=rowsArray[i]&&(2==rowsArray[i].split(",").length?p0Cart[i]=rowsArray[i].split(","):e=1);p0Canvas=cartToCanvas(p0Cart)}p0Cart.length>6&&(e=2),0==e&&(draw(p0Canvas,p0Color,0),enableTransformations()),1==e&&(document.getElementById("status").innerHTML="There's something wrong with your coordinate pairs. Make sure you only use numbers, commas and the negative sign.",clear()),2==e&&(document.getElementById("status").innerHTML="You have too many vertices! Make sure you have six coordinate pairs or fewer.",clear())}function cartToCanvas(e){var t=[];for(i=0;i<e.length;i++)t[i]=[Number(e[i][0])*gridSize+planeWidth/2,-Number(e[i][1])*gridSize+planeHeight/2];return t}function canvasToCart(e){var t=[];for(i=0;i<e.length;i++)t[i]=[(Number(e[i][0])-planeWidth/2)/gridSize,-(Number(e[i][1])-planeHeight/2)/gridSize];return t}function draw(e,t,n){for(document.getElementById("status").innerHTML="",ctx.beginPath(),ctx.moveTo(e[0][0],e[0][1]),i=1;i<e.length;i++)ctx.lineTo(e[i][0],e[i][1]);ctx.closePath(),ctx.lineWidth=gridSize/8,ctx.strokeStyle=t,1==e.length&&ctx.strokeRect(e[0][0]-gridSize/16,e[0][1]-gridSize/16,gridSize/8,gridSize/8),ctx.stroke(),drawn=!0,labelPoly(e,n),xyCart=canvasToCart(e),updatePolyList(xyCart,n)}function translate(e,t,n){for(xyCartOut=[],i=0;i<e.length;i++)xyCartOut[i]=[Number(e[i][0])+t,Number(e[i][1])+n];return xyCartOut}function translateExec(){switch(document.getElementById("undoButton").disabled=!1,polygon+=1,amtX=Number(document.getElementById("translateX").value),amtY=Number(document.getElementById("translateY").value),polygon){case 1:p1Cart=translate(p0Cart,amtX,amtY),draw(p1Canvas=cartToCanvas(p1Cart),p1Color,1),document.getElementById("transform1").innerHTML="&#8594;<br>Translated<br>"+amtX+" in x<br>"+amtY+" in y<br>&#8594;";break;case 2:p2Cart=translate(p1Cart,amtX,amtY),draw(p2Canvas=cartToCanvas(p2Cart),p2Color,2),document.getElementById("transform2").innerHTML="&#8594;<br>Translated<br>"+amtX+" in x<br>"+amtY+" in y<br>&#8594;";break;case 3:p3Cart=translate(p2Cart,amtX,amtY),draw(p3Canvas=cartToCanvas(p3Cart),p3Color,3),disableTransformations(),document.getElementById("transform3").innerHTML="&#8594;<br>Translated<br>"+amtX+" in x<br>"+amtY+" in y<br>&#8594;"}}function reflectX(e,t){for(xyCartOut=[],i=0;i<e.length;i++)xyCartOut[i]=[2*t-Number(e[i][0]),Number(e[i][1])];return xyCartOut}function reflectY(e,t){for(xyCartOut=[],i=0;i<e.length;i++)xyCartOut[i]=[Number(e[i][0]),2*t-Number(e[i][1])];return xyCartOut}function reflectXExec(e){switch(document.getElementById("undoButton").disabled=!1,polygon+=1,xEq=e?0:Number(document.getElementById("reflectX").value),polygon){case 1:p1Cart=reflectX(p0Cart,xEq),draw(p1Canvas=cartToCanvas(p1Cart),p1Color,1),document.getElementById("transform1").innerHTML="&#8594;<br>Reflected<br>over<br>x = "+document.getElementById("reflectX").value+"<br>&#8594;";break;case 2:p2Cart=reflectX(p1Cart,xEq),draw(p2Canvas=cartToCanvas(p2Cart),p2Color,2),document.getElementById("transform2").innerHTML="&#8594;<br>Reflected<br>over<br>x = "+document.getElementById("reflectX").value+"<br>&#8594;";break;case 3:p3Cart=reflectX(p2Cart,xEq),draw(p3Canvas=cartToCanvas(p3Cart),p3Color,3),document.getElementById("transform3").innerHTML="&#8594;<br>Reflected<br>over<br>x = "+document.getElementById("reflectX").value+"<br>&#8594;",disableTransformations()}}function reflectYExec(e){switch(document.getElementById("undoButton").disabled=!1,polygon+=1,yEq=e?0:Number(document.getElementById("reflectY").value),polygon){case 1:p1Cart=reflectY(p0Cart,yEq),draw(p1Canvas=cartToCanvas(p1Cart),p1Color,1),document.getElementById("transform1").innerHTML="&#8594;<br>Reflected<br>over<br>y = "+document.getElementById("reflectY").value+"<br>&#8594;";break;case 2:p2Cart=reflectY(p1Cart,yEq),draw(p2Canvas=cartToCanvas(p2Cart),p2Color,2),document.getElementById("transform2").innerHTML="&#8594;<br>Reflected<br>over<br>y = "+document.getElementById("reflectY").value+"<br>&#8594;";break;case 3:p3Cart=reflectY(p2Cart,yEq),draw(p3Canvas=cartToCanvas(p3Cart),p3Color,3),document.getElementById("transform3").innerHTML="&#8594;<br>Reflected<br>over<br>y = "+document.getElementById("reflectY").value+"<br>&#8594;",disableTransformations()}}function rotate(e,t,n){switch(xyCartOut=[],t){case"90":if("CW"==n)for(i=0;i<e.length;i++)xyCartOut[i]=[Number(e[i][1]),-Number(e[i][0])];else for(i=0;i<e.length;i++)xyCartOut[i]=[-Number(e[i][1]),Number(e[i][0])];break;case"180":for(i=0;i<e.length;i++)xyCartOut[i]=[-Number(e[i][0]),-Number(e[i][1])];break;case"270":if("CCW"==n)for(i=0;i<e.length;i++)xyCartOut[i]=[Number(e[i][1]),-Number(e[i][0])];else for(i=0;i<e.length;i++)xyCartOut[i]=[-Number(e[i][1]),Number(e[i][0])]}return xyCartOut}function rotateExec(){switch(document.getElementById("undoButton").disabled=!1,polygon+=1,degrees=document.querySelector('input[name="degrees"]:checked').value,direction=document.querySelector('input[name="direction"]:checked').value,polygon){case 1:p1Cart=rotate(p0Cart,degrees,direction),draw(p1Canvas=cartToCanvas(p1Cart),p1Color,1),document.getElementById("transform1").innerHTML="&#8594;<br>Rotated<br>"+degrees+"&deg; "+direction+"<br>&#8594;";break;case 2:p2Cart=rotate(p1Cart,degrees,direction),draw(p2Canvas=cartToCanvas(p2Cart),p2Color,2),document.getElementById("transform2").innerHTML="&#8594;<br>Rotated<br>"+degrees+"&deg; "+direction+"<br>&#8594;";break;case 3:p3Cart=rotate(p2Cart,degrees,direction),draw(p3Canvas=cartToCanvas(p3Cart),p3Color,3),document.getElementById("transform3").innerHTML="&#8594;<br>Rotated<br>"+degrees+"&deg; "+direction+"<br>&#8594;",disableTransformations()}}function dilate(e,t){for(xyCartOut=[],i=0;i<e.length;i++)xyCartOut[i]=[Number(e[i][0])*t,Number(e[i][1])*t];return xyCartOut}function dilateExec(){switch(document.getElementById("undoButton").disabled=!1,polygon+=1,scale=Number(document.getElementById("scale").value),polygon){case 1:p1Cart=dilate(p0Cart,scale),draw(p1Canvas=cartToCanvas(p1Cart),p1Color,1),document.getElementById("transform1").innerHTML="&#8594;<br>Dilated with<br>scale factor<br>"+document.getElementById("scale").value+"<br>&#8594;";break;case 2:p2Cart=dilate(p1Cart,scale),draw(p2Canvas=cartToCanvas(p2Cart),p2Color,2),document.getElementById("transform2").innerHTML="&#8594;<br>Dilated with<br>scale factor<br>"+document.getElementById("scale").value+"<br>&#8594;";break;case 3:p3Cart=dilate(p2Cart,scale),draw(p3Canvas=cartToCanvas(p3Cart),p3Color,3),document.getElementById("transform3").innerHTML="&#8594;<br>Dilated with<br>scale factor<br>"+document.getElementById("scale").value+"<br>&#8594;",disableTransformations()}}function disableTransformations(){document.getElementById("translateButton").disabled=!0,document.getElementById("reflectXButton").disabled=!0,document.getElementById("reflectYButton").disabled=!0,document.getElementById("reflectXAxisButton").disabled=!0,document.getElementById("reflectYAxisButton").disabled=!0,document.getElementById("rotateButton").disabled=!0,document.getElementById("dilateButton").disabled=!0,document.getElementById("status").innerHTML="You've used all three transformations. Hit Undo transformation, or Clear and then Draw to try again!"}function enableTransformations(){document.getElementById("translateButton").disabled=!1,document.getElementById("reflectXButton").disabled=!1,document.getElementById("reflectYButton").disabled=!1,document.getElementById("reflectXAxisButton").disabled=!1,document.getElementById("reflectYAxisButton").disabled=!1,document.getElementById("rotateButton").disabled=!1,document.getElementById("dilateButton").disabled=!1,document.getElementById("clearButton").disabled=!1,document.getElementById("drawp0Button").disabled=!0,document.getElementById("showValuesButton").disabled=!1}function labelPoly(e,t){switch(t){case 0:labels=["A","B","C","D","E","F"],labelColor=p0Color;break;case 1:labels=["A'","B'","C'","D'","E'","F'"],labelColor=p1Color;break;case 2:labels=["A''","B''","C''","D''","E''","F''"],labelColor=p2Color;break;case 3:labels=["A'''","B'''","C'''","D'''","E'''","F'''"],labelColor=p3Color}var n=0,a=0;for(i=0;i<e.length;i++)n+=Number(e[i][0]),a+=Number(e[i][1]);xAvg=n/e.length,yAvg=a/e.length,ctx.font="20px Arial",ctx.fillStyle=labelColor,ctx.textBaseline="middle",ctx.textAlign="center";var r=Math.sqrt(gridSize)+7;for(i=0;i<e.length;i++)Number(e[i][0])<=xAvg?xBuffer=-r:xBuffer=r,Number(e[i][1])<=yAvg?yBuffer=-r:yBuffer=r,ctx.fillText(labels[i],e[i][0]+xBuffer,e[i][1]+yBuffer)}function updatePolyList(e,t){switch(t){case 0:labels=["A","B","C","D","E","F"],document.getElementById("p0list").innerHTML=generatePolyList(e,labels,t),document.getElementById("p0name").innerHTML="Shape<br>"+generatePolyName(e,labels,t);break;case 1:labels=["A'","B'","C'","D'","E'","F'"],document.getElementById("p1list").innerHTML=generatePolyList(e,labels,t),document.getElementById("p1name").innerHTML="Shape<br>"+generatePolyName(e,labels,t);break;case 2:labels=["A''","B''","C''","D''","E''","F''"],document.getElementById("p2list").innerHTML=generatePolyList(e,labels,t),document.getElementById("p2name").innerHTML="Shape<br>"+generatePolyName(e,labels,t);break;case 3:labels=["A'''","B'''","C'''","D'''","E'''","F'''"],document.getElementById("p3list").innerHTML=generatePolyList(e,labels,t),document.getElementById("p3name").innerHTML="Shape<br>"+generatePolyName(e,labels,t)}}function generatePolyList(e,t,n){for(list=t.join("").substring(0,e.length*(n+1))+"<br>",i=0;i<e.length;i++)list+=t[i]+": ("+Math.round(100*e[i][0])/100+", "+Math.round(100*e[i][1])/100+") <br>";return list}function generatePolyName(e,t,n){return name=t.join("").substring(0,e.length*(n+1)),name}function clear(){document.getElementById("clearButton").disabled=!0,document.getElementById("drawp0Button").disabled=!1,document.getElementById("undoButton").disabled=!0,ctx.clearRect(0,0,c.width,c.height),disableTransformations(),drawBackground(),p0Canvas=[],p0Cart=[],p1Canvas=[],p1Cart=[],p2Canvas=[],p2Cart=[],p3Canvas=[],p3Cart=[],polygon=0,rowsArray=[],drawn=!1,document.getElementById("p0list").innerHTML="",document.getElementById("p1list").innerHTML="",document.getElementById("p2list").innerHTML="",document.getElementById("p3list").innerHTML="",document.getElementById("p0name").innerHTML="",document.getElementById("p1name").innerHTML="",document.getElementById("p2name").innerHTML="",document.getElementById("p3name").innerHTML="",document.getElementById("transform1").innerHTML="",document.getElementById("transform2").innerHTML="",document.getElementById("transform3").innerHTML="",showValues=!1,document.getElementById("showValuesButton").innerHTML="Show coordinate<br>values",document.getElementById("showValuesButton").disabled=!0,document.getElementById("p0list").style.display="none",document.getElementById("p1list").style.display="none",document.getElementById("p2list").style.display="none",document.getElementById("p3list").style.display="none",document.getElementById("p0name").style.display="block",document.getElementById("p1name").style.display="block",document.getElementById("p2name").style.display="block",document.getElementById("p3name").style.display="block",document.getElementById("status").innerHTML="Add three to six coordinate pairs to the Vertices area and hit Draw to get started!"}function zoom(e){switch(e){case"2":gridSize=50;break;case"1":gridSize=25;break;case"0":gridSize=10}ctx.clearRect(0,0,c.width,c.height),drawBackground(),polygon>=0&&(p0Canvas=cartToCanvas(p0Cart),1==drawn&&draw(p0Canvas,p0Color,0)),polygon>=1&&draw(p1Canvas=cartToCanvas(p1Cart),p1Color,1),polygon>=2&&draw(p2Canvas=cartToCanvas(p2Cart),p2Color,2),polygon>=3&&draw(p3Canvas=cartToCanvas(p3Cart),p3Color,3)}function vertexValues(){0==showValues?(document.getElementById("p0list").style.display="block",document.getElementById("p1list").style.display="block",document.getElementById("p2list").style.display="block",document.getElementById("p3list").style.display="block",document.getElementById("p0name").style.display="none",document.getElementById("p1name").style.display="none",document.getElementById("p2name").style.display="none",document.getElementById("p3name").style.display="none",showValues=!0,document.getElementById("showValuesButton").innerHTML="Hide coordinate<br>values"):(document.getElementById("p0list").style.display="none",document.getElementById("p1list").style.display="none",document.getElementById("p2list").style.display="none",document.getElementById("p3list").style.display="none",document.getElementById("p0name").style.display="block",document.getElementById("p1name").style.display="block",document.getElementById("p2name").style.display="block",document.getElementById("p3name").style.display="block",document.getElementById("showValuesButton").innerHTML="Show coordinate<br>values",showValues=!1)}function undo(){switch(ctx.clearRect(0,0,c.width,c.height),drawBackground(),document.getElementById("p0list").innerHTML="",document.getElementById("p1list").innerHTML="",document.getElementById("p2list").innerHTML="",document.getElementById("p3list").innerHTML="",document.getElementById("p0name").innerHTML="",document.getElementById("p1name").innerHTML="",document.getElementById("p2name").innerHTML="",document.getElementById("p3name").innerHTML="",polygon){case 1:p1Cart=[],p1Canvas=[],draw(p0Canvas,p0Color,0),document.getElementById("undoButton").disabled=!0,document.getElementById("transform1").innerHTML="";break;case 2:p2Cart=[],p2Canvas=[],draw(p0Canvas,p0Color,0),draw(p1Canvas,p1Color,1),document.getElementById("transform2").innerHTML="";break;case 3:p3Cart=[],p3Canvas=[],draw(p0Canvas,p0Color,0),draw(p1Canvas,p1Color,1),draw(p2Canvas,p2Color,2),document.getElementById("transform3").innerHTML="",enableTransformations()}polygon-=1}function showOnlyFirstAndLast(){switch(ctx.clearRect(0,0,c.width,c.height),drawBackground(),draw(p0Canvas,p0Color,0),polygon){case 1:draw(p1Canvas,p1Color,1);break;case 2:draw(p2Canvas,p2Color,2);break;case 3:draw(p3Canvas,p3Color,3)}}disableTransformations(),document.getElementById("clearButton").disabled=!0,document.getElementById("undoButton").disabled=!0,drawBackground(),document.getElementById("pairsInput").value="0,0",document.getElementById("translateX").value="0",document.getElementById("translateY").value="0",document.getElementById("reflectX").value="0",document.getElementById("reflectY").value="0",document.getElementById("scale").value="1",document.getElementById("p0list").style.display="none",document.getElementById("p1list").style.display="none",document.getElementById("p2list").style.display="none",document.getElementById("p3list").style.display="none",document.getElementById("showValuesButton").disabled=!0,document.getElementById("status").innerHTML="Add three to six coordinate pairs to the Vertices area and hit Draw to get started!",document.getElementById("drawp0Button").onclick=function(){drawp0()},document.getElementById("clearButton").onclick=function(){clear()},document.getElementById("zoomRange").onchange=function(){zoom(document.getElementById("zoomRange").value)},document.getElementById("translateButton").onclick=function(){translateExec()},document.getElementById("reflectXButton").onclick=function(){reflectXExec(!1)},document.getElementById("reflectYButton").onclick=function(){reflectYExec(!1)},document.getElementById("reflectXAxisButton").onclick=function(){reflectYExec(!0)},document.getElementById("reflectYAxisButton").onclick=function(){reflectXExec(!0)},document.getElementById("rotateButton").onclick=function(){rotateExec()},document.getElementById("dilateButton").onclick=function(){dilateExec()},document.getElementById("showValuesButton").onclick=function(){vertexValues()},document.getElementById("undoButton").onclick=function(){polygon>0&&undo()};